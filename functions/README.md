## Fitness-fatigue model functions (toolbox)

### Files

#### Functions summary

| Function          | File                  | Functionality    | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|-------------------|-----------------------|------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| basicModel()      | [basicModel.R]()      | Train/test       | One component model </br> </br><img src="https://latex.codecogs.com/svg.latex?\hat{p}(n)&space;=&space;p^*&space;&plus;&space;K\sum_{i=1}^{n-1}&space;\omega(i)&space;\cdot&space;(e^{-\frac{(n-i)}{\tau}})" title="\hat{p}(n) = p^* + K\sum_{i=1}^{n-1} \omega(i) \cdot (e^{-\frac{(n-i)}{\tau}})" /></br></br> With an initial component </br> </br> <img src="https://latex.codecogs.com/svg.latex?\hat{p}(n)&space;=&space;p^*&space;&plus;&space;q\cdot(e^{\frac{-n}{\tau}})&space;&plus;&space;K\sum_{i=1}^{n-1}&space;\omega(i)&space;\cdot&space;(e^{-\frac{(n-i)}{\tau}})" title="\hat{p}(n) = p^* + q\cdot(e^{\frac{-n}{\tau}}) + K\sum_{i=1}^{n-1} \omega(i) \cdot (e^{-\frac{(n-i)}{\tau}})" />                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| standardModelX1() | [standardModelX1.R]() | Train/Test       | The standard model with 1 scaling factor only </br></br>  <img src="https://latex.codecogs.com/svg.latex?\hat{p}(n)&space;=&space;p^*&space;&plus;&space;K\sum_{i=1}^{n-1}&space;\omega(i)&space;\cdot&space;(e^{-\frac{(n-i)}{\tau_g}}-e^{-\frac{(n-i)}{\tau_h}})" title="\hat{p}(n) = p^* + K\sum_{i=1}^{n-1} \omega(i) \cdot (e^{-\frac{(n-i)}{\tau_g}}-e^{-\frac{(n-i)}{\tau_h}})" /> </br></br> With two initial components </br> </br>  <img src="https://latex.codecogs.com/svg.latex?\hat{p}(n)&space;=&space;p^*&space;&plus;&space;q_g&space;\cdot&space;(e^{\frac{-n}{\tau_g}})&space;&plus;&space;q_h&space;\cdot&space;(e^{\frac{-n}{\tau_h}})&space;&plus;&space;K\sum_{i=1}^{n-1}&space;\omega(i)\cdot&space;(e^{-\frac{(n-i)}{\tau_g}}-e^{-\frac{(n-i)}{\tau_h}})" title="\hat{p}(n) = p^* + q_g \cdot (e^{\frac{-n}{\tau_g}}) + q_h \cdot (e^{\frac{-n}{\tau_h}}) + K\sum_{i=1}^{n-1} \omega(i)\cdot (e^{-\frac{(n-i)}{\tau_g}}-e^{-\frac{(n-i)}{\tau_h}})" />                                                                                                                                                                                                               |
| standardModel()   | [standardModel.R]()   | Train/Test       | Standard model </br> </br> <img src="https://latex.codecogs.com/svg.latex?\hat{p}(n)&space;=&space;p^*&space;&plus;&space;k_g\sum_{i=1}^{n-1}&space;\omega(i)&space;\cdot&space;(e^{-\frac{(n-i)}{\tau_g}})&space;-&space;k_h\sum_{i=1}^{n-1}&space;\omega(i)&space;\cdot&space;(e^{-\frac{(n-i)}{\tau_h}})" title="\hat{p}(n) = p^* + k_g\sum_{i=1}^{n-1} \omega(i) \cdot (e^{-\frac{(n-i)}{\tau_g}}) - k_h\sum_{i=1}^{n-1} \omega(i) \cdot (e^{-\frac{(n-i)}{\tau_h}})" /></br></br> With two initial components </br></br> <img src="https://latex.codecogs.com/svg.latex?\small&space;\hat{p}(n)&space;=&space;p^*&space;&plus;&space;q_g\cdot&space;(e^{-\frac{n}{\tau_g}})&space;&plus;&space;q_h\cdot&space;(e^{-\frac{n}{\tau_h}})&space;&plus;&space;k_g\sum_{i=1}^{n-1}&space;\omega(i)&space;\cdot&space;(e^{-\frac{(n-i)}{\tau_g}})&space;-&space;k_h\sum_{i=1}^{n-1}&space;\omega(i)&space;\cdot&space;(e^{-\frac{(n-i)}{\tau_h}})" title="\small \hat{p}(n) = p^* + q_g\cdot (e^{-\frac{n}{\tau_g}}) + q_h\cdot (e^{-\frac{n}{\tau_h}}) + k_g\sum_{i=1}^{n-1} \omega(i) \cdot (e^{-\frac{(n-i)}{\tau_g}}) - k_h\sum_{i=1}^{n-1} \omega(i) \cdot (e^{-\frac{(n-i)}{\tau_h}})" /> |
| banisterModel()   | [banisterModel.R]()   | Solve/Train/Test | One component system (Basic model) </br></br> <img src="https://latex.codecogs.com/svg.latex?p(t)&space;=&space;p^*&space;&plus;&space;Kp(t)&space;\\" title="p(t) = p^* + Kp(t) \\" /></br> <img src="https://latex.codecogs.com/svg.latex?p'(t)&space;=&space;\omega(t)&space;-&space;\frac{1}{\tau}&space;p(t)" title="p'(t) = \omega(t) - \frac{1}{\tau} p(t)" /> </br></br>  Two component system (standard model) </br></br> <img src="https://latex.codecogs.com/svg.latex?p(t)&space;=&space;k_g\cdot&space;g(t)&space;-&space;k_h&space;\cdot&space;h(t))&space;\\&space;\\&space;g'(t)&space;=&space;\omega(t)&space;-&space;\frac{1}{\tau_g}\cdot&space;g(t)&space;\\&space;h'(t)&space;=&space;\omega(t)&space;-&space;\frac{1}{\tau_h}\cdot&space;g(t)&space;\\" title="p(t) = k_g\cdot g(t) - k_h \cdot h(t)) \\ \\ g'(t) = \omega(t) - \frac{1}{\tau_g}\cdot g(t) \\ h'(t) = \omega(t) - \frac{1}{\tau_h}\cdot g(t) \\" />                                                                                                                                                                                                                                               |
| turnerModel()     | [turnerModel.R]()     | Solve/Train/Test | Non-linear variant of the original model </br> </br> <img src="https://latex.codecogs.com/svg.latex?p(t)&space;=&space;k_g\cdot&space;g(t)&space;-&space;k_h&space;\cdot&space;h(t))&space;\\&space;\\&space;g'(t)&space;=&space;\omega(t)&space;-&space;\frac{1}{\tau_g}\cdot&space;g(t)^\alpha&space;\\&space;h'(t)&space;=&space;\omega(t)&space;-&space;\frac{1}{\tau_h}\cdot&space;g(t)^\beta&space;\\" title="p(t) = k_g\cdot g(t) - k_h \cdot h(t)) \\ \\ g'(t) = \omega(t) - \frac{1}{\tau_g}\cdot g(t)^\alpha \\ h'(t) = \omega(t) - \frac{1}{\tau_h}\cdot g(t)^\beta \\" />                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| calvertModel()    | [calvertModel.R]()    | Train/Test       | Standard model with delay term on fitness </br></br>  Formula TBC                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| vdrModel()        | [vdrModel.R]()        | Train/Test       | Variable dose-response model </br> </br> <img src="https://latex.codecogs.com/svg.latex?\hat{p}(t)=p^*&space;&plus;&space;k_g&space;\sum_{i=1}^{n-1}&space;\omega(i)(e^{-\frac{(n-i)}{\tau_g}})-k_h\sum_{i=1}^{n-1}&space;k^i_h_2&space;(e^{-\frac{(n-i)}{\tau_h}})" title="\hat{p}(t)=p^* + k_g \sum_{i=1}^{n-1} \omega(i)(e^{-\frac{(n-i)}{\tau_g}})-k_h\sum_{i=1}^{n-1} k^i_h_2 (e^{-\frac{(n-i)}{\tau_h}})" /> </br></br> *Where*: </br></br> <img src="https://latex.codecogs.com/svg.latex?k^i_h_2&space;=&space;\sum_{j=1}^{i}&space;\omega(j)(e^{-\frac{(i-j)}{\tau_h_2}})" title="k^i_h_2 = \sum_{j=1}^{i} \omega(j)(e^{-\frac{(i-j)}{\tau_h_2}})" />                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| TBC               | TBC                   | TBC              | Standard Model Estimation with Kalman-filter feedback and Hill transform </br></br>  Ben to confirm further details                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| parScaling()      | [parScaling.R]()      | Compute          | Function to determine appropriate (optional) scaling values for the parameters given a set of data                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| computeModel()    | [computeModels.R]()   | Compute          | Compute model output (from a list of available models) for a defined set of parameters and load series                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |

#### Further information

| Function          | Optim               | Cross-validation | Estimates                                                                                                                                                                                                                                                                                                                 | Initial conditions                                                                                                                                                                                                                                        | Package dependencies | Documentation |
|-------------------|---------------------|------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------|---------------|
| basicModel()      | TBC                 | Expanding window | <img src="https://latex.codecogs.com/svg.latex?\small&space;p^*,K,\tau" title="\small p^*,K,\tau" /> </br></br> Optional </br> <img src="https://latex.codecogs.com/svg.latex?\small&space;q" title="\small q" />                                                                                                         | Initial component <img src="https://latex.codecogs.com/svg.latex?\small&space;q" title="\small q" /> can be fitted, otherwise assumes <img src="https://latex.codecogs.com/svg.latex?\small&space;g(0)=0" title="\small g(0)=0" />                        | TBC                  | TBC           |
| standardModelX1() | TBC                 | Expanding window | <img src="https://latex.codecogs.com/svg.latex?\small&space;p^*,&space;K,&space;\tau_g,&space;\tau_h" title="\small p^*, K, \tau_g, \tau_h" /> </br></br> Optional </br> <img src="https://latex.codecogs.com/svg.latex?\small&space;q_g,q_h" title="\small q_g,q_h" />                                                   | Initial components <img src="https://latex.codecogs.com/svg.latex?\small&space;q_g,q_h" title="\small q_g,q_h" /> can be fitted, otherwise assumes <img src="https://latex.codecogs.com/svg.latex?\small&space;g(0)=h(0)=0" title="\small g(0)=h(0)=0" /> | TBC                  | TBC           |
| banisterModel()   | TBC                 | Expanding window | One component </br> <img src="https://latex.codecogs.com/svg.latex?\small&space;p^*,K,\tau,p(0)" title="\small p^*,K,\tau,p(0)" /> </br></br> Two components </br> <img src="https://latex.codecogs.com/svg.latex?\small&space;p^*,k_g,k_h,\tau_g,\tau_h,g(0),h(0)" title="\small p^*,k_g,k_h,\tau_g,\tau_h,g(0),h(0)" /> | Estimated during fitting or can be fixed to zero                                                                                                                                                                                                          | TBC                  | TBC           |
| turnerModel()     | GA </br> (Parallel) | Expanding window | <img src="https://latex.codecogs.com/svg.latex?\small&space;p^*,g(0),h(0),k_g,k_h,\tau_g,\tau_h,\alpha,\beta" title="\small p^*,g(0),h(0),k_g,k_h,\tau_g,\tau_h,\alpha,\beta" />                                                                                                                                          | Estimated                                                                                                                                                                                                                                                 | TBC                  | TBC           |
| calvertModel()    | TBC                 | Expanding window | TBC - figure out model formula first                                                                                                                                                                                                                                                                                      | TBC                                                                                                                                                                                                                                                       | TBC                  | TBC           |
| vdrModel()        | TBC                 | Expanding window | <img src="https://latex.codecogs.com/svg.latex?\small&space;p^*,&space;k_g,&space;\tau_g,&space;k_h,&space;\tau_h,&space;\tau_h_2," title="\small p^*, k_g, \tau_g, k_h, \tau_h, \tau_h_2," />                                                                                                                            | TBC - potentially use initial conditions                                                                                                                                                                                                                  | TBC                  | TBC           |
| parScaling()      | NA                  | NA               | NA                                                                                                                                                                                                                                                                                                                        | NA                                                                                                                                                                                                                                                        | TBC                  | TBC           |
| modelCompute()    | NA                  | NA               | NA                                                                                                                                                                                                                                                                                                                        | NA                                                                                                                                                                                                                                                        | TBC                  | TBC           |

### Documentation and data TODO Notes

- Provide authors code and documentation where appropriate
- Provide link to original research
- Provide link to example code file (.R) with data file link
- Provide link to text / markdown resource
